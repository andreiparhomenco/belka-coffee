# üöÄ –ü–û–õ–ù–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ú–ò–ì–†–ê–¶–ò–ò –ë–î

**–ï—Å–ª–∏ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –æ—à–∏–±–∫—É "relation users does not exist"**

---

## ‚ö° –ë–´–°–¢–†–´–ô –°–ü–û–°–û–ë (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

### –®–ê–ì 1: –û—Ç–∫—Ä–æ–π—Ç–µ SQL Editor

```
https://supabase.com/dashboard/project/jcrjcglfzrhcghiqfltp/editor
```

### –®–ê–ì 2: –í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª **`FULL_MIGRATION_SETUP.sql`** –≤ —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **–í–ï–°–¨ –§–ê–ô–õ** (Ctrl+A ‚Üí Ctrl+C)
3. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor –≤ Supabase
4. –ù–∞–∂–º–∏—Ç–µ **"Run"** ‚ñ∂Ô∏è (–∏–ª–∏ Ctrl+Enter)
5. –î–æ–∂–¥–∏—Ç–µ—Å—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (~5-10 —Å–µ–∫—É–Ω–¥)

**–î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:**
```
Success. No rows returned
```

‚úÖ **–ì–æ—Ç–æ–≤–æ! –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã!**

---

### –®–ê–ì 3: –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ Authentication

–û—Ç–∫—Ä–æ–π—Ç–µ:
```
https://supabase.com/dashboard/project/jcrjcglfzrhcghiqfltp/auth/users
```

#### –°–æ–∑–¥–∞–π—Ç–µ –ê–î–ú–ò–ù–ê:
1. –ù–∞–∂–º–∏—Ç–µ **"Add user"** ‚Üí **"Create new user"**
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   ```
   Email: admin@belka.coffee
   Password: BelkaAdmin2024
   ‚òëÔ∏è Auto Confirm User (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)
   ```
3. –ù–∞–∂–º–∏—Ç–µ **"Create user"**
4. **–°–ö–û–ü–ò–†–£–ô–¢–ï UUID** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### –°–æ–∑–¥–∞–π—Ç–µ –ë–ê–†–ò–°–¢–ê:
1. **"Add user"** ‚Üí **"Create new user"**
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   ```
   Email: barista@belka.coffee
   Password: BelkaBarista2024
   ‚òëÔ∏è Auto Confirm User (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)
   ```
3. –ù–∞–∂–º–∏—Ç–µ **"Create user"**
4. **–°–ö–û–ü–ò–†–£–ô–¢–ï UUID** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### –®–ê–ì 4: –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ç–∞–±–ª–∏—Ü—É users

–í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ SQL Editor –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –ê–î–ú–ò–ù (‚ö†Ô∏è –ó–ê–ú–ï–ù–ò–¢–ï UUID!)
INSERT INTO users (id, email, name, role, telegram_id)
VALUES (
  '–í–ê–®_UUID_–ê–î–ú–ò–ù–ê_–ó–î–ï–°–¨',  -- ‚ö†Ô∏è UUID –∏–∑ Auth!
  'admin@belka.coffee',
  '–ê–Ω–¥—Ä–µ–π –ü–∞—Ä—Ö–æ–º–µ–Ω–∫–æ (–ê–¥–º–∏–Ω)',
  'admin',
  NULL
)
ON CONFLICT (email) 
DO UPDATE SET 
  id = EXCLUDED.id,
  role = 'admin',
  name = '–ê–Ω–¥—Ä–µ–π –ü–∞—Ä—Ö–æ–º–µ–Ω–∫–æ (–ê–¥–º–∏–Ω)';

-- –ë–ê–†–ò–°–¢–ê (‚ö†Ô∏è –ó–ê–ú–ï–ù–ò–¢–ï UUID!)
INSERT INTO users (id, email, name, role, telegram_id)
VALUES (
  '–í–ê–®_UUID_–ë–ê–†–ò–°–¢–ê_–ó–î–ï–°–¨',  -- ‚ö†Ô∏è UUID –∏–∑ Auth!
  'barista@belka.coffee',
  '–ë–∞—Ä–∏—Å—Ç–∞ –¢–µ—Å—Ç–æ–≤—ã–π',
  'barista',
  NULL
)
ON CONFLICT (email) 
DO UPDATE SET 
  id = EXCLUDED.id,
  role = 'barista';
```

–ù–∞–∂–º–∏—Ç–µ **"Run"** ‚ñ∂Ô∏è

---

### –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

```sql
SELECT id, email, name, role 
FROM users 
WHERE email IN ('admin@belka.coffee', 'barista@belka.coffee');
```

**–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å 2 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!**

---

## ‚úÖ –ì–û–¢–û–í–û!

–¢–µ–ø–µ—Ä—å –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```
http://localhost:5173
```

–ò –≤–æ–π–¥–∏—Ç–µ:
- Email: `admin@belka.coffee`
- –ü–∞—Ä–æ–ª—å: `BelkaAdmin2024`

---

## üÜò TROUBLESHOOTING

### –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞?

**"relation already exists"** - –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –ü—Ä–æ—Å—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ, —Ç–∞–±–ª–∏—Ü–∞ —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞.

**"permission denied"** - –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã –∑–∞–ª–æ–≥–∏–Ω–µ–Ω—ã –≤ Supabase –∏ –≤—ã–±—Ä–∞–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç.

**–î—Ä—É–≥–∞—è –æ—à–∏–±–∫–∞?** - –ù–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏!

---

## üìã –ß–¢–û –°–û–ó–î–ê–Å–¢ –≠–¢–û–¢ –°–ö–†–ò–ü–¢

–¢–∞–±–ª–∏—Ü—ã:
- ‚úÖ `users` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- ‚úÖ `shop_template` - –®–∞–±–ª–æ–Ω —Ä–∞–±–æ—Ç—ã –∫–æ—Ñ–µ–π–Ω–∏
- ‚úÖ `availability` - –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –±–∞—Ä–∏—Å—Ç–∞
- ‚úÖ `shifts` - –ù–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ —Å–º–µ–Ω—ã
- ‚úÖ `shift_reports` - –û—Ç—á—ë—Ç—ã –ø–æ —Å–º–µ–Ω–∞–º
- ‚úÖ `salaries` - –ó–∞—Ä–ø–ª–∞—Ç—ã
- ‚úÖ `audit_log` - –ê—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π

RLS –ü–æ–ª–∏—Ç–∏–∫–∏:
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ê–¥–º–∏–Ω—ã –≤–∏–¥—è—Ç –∏ —É–ø—Ä–∞–≤–ª—è—é—Ç –≤—Å–µ–º
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î

–ò–Ω–¥–µ–∫—Å—ã –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã:
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ timestamps
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏

---

**–£–¥–∞—á–∏!** üöÄ

